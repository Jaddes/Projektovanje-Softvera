üìÑ **Pull Request Template za Backend**
<hr>

üéØ **Change goal**
- User story: "Kao turista ili autor ≈æelim da pogledam i a≈æuriram svoj profil (ime, prezime, profilna slika, biografija, moto) kako bih se predstavio drugim korisnicima."
- Acceptance criteria:
  - Autentifikovani turista/autor mo≈æe da pozove `GET /api/{role}/profile` i dobije popunjena polja (name, surname, biography, motto, profilePictureUrl) vezana za svog PersonId.
  - Autentifikovani turista/autor mo≈æe da pozove `PUT /api/{role}/profile` sa ne-praznim imenom/prezimenom i biografijom/motom du≈æine ‚â§ 250 karaktera; podatak se ƒçuva u bazi i vraƒáa a≈æurirani DTO.
  - Profil se kreira automatski pri prvom pozivu ako ne postoji, vezan je uz postojeƒáeg Person-a i jedan Person ima taƒçno jedan profil (unique indeks na PersonId).
<hr>

üóÑÔ∏è **Izmene nad bazom**
- Nova tabela `stakeholders."Profiles"` sa kolona-ma: `Id`, `Name`, `Surname`, `Biography` (varchar(250)), `Motto` (varchar(250)), `ProfilePictureUrl`, `PersonId` (FK na `stakeholders."People"`), jedinstveni indeks na `PersonId`.
```sql
-- Primer DDL-a
CREATE TABLE stakeholders."Profiles"(
    "Id" bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "Name" text NOT NULL,
    "Surname" text NOT NULL,
    "Biography" character varying(250),
    "Motto" character varying(250),
    "ProfilePictureUrl" text,
    "PersonId" bigint NOT NULL UNIQUE REFERENCES stakeholders."People"("Id")
);
```

**Migracije koje je potrebno pokrenuti radi testiranja:**
```bash
# kreiranje migracije za Stakeholders modul (primer naziva)
dotnet ef migrations add AddProfileTable \
  --project src/Modules/Stakeholders/Explorer.Stakeholders.Infrastructure \
  --startup-project src/Explorer.API/Explorer.API.csproj \
  --context StakeholdersContext \
  --output-dir Database/Migrations

# primena migracije
dotnet ef database update \
  --project src/Modules/Stakeholders/Explorer.Stakeholders.Infrastructure \
  --startup-project src/Explorer.API/Explorer.API.csproj \
  --context StakeholdersContext
```

**Seed skripta (putanja do seed skripte koju kolega treba da pokrene nakon migracija da bi testirao funkcionalnost):**
- `src/Modules/Stakeholders/Explorer.Stakeholders.Tests/TestData/a-delete.sql` (ƒçisti Users/People/Profiles)
- `src/Modules/Stakeholders/Explorer.Stakeholders.Tests/TestData/b-users.sql`
- `src/Modules/Stakeholders/Explorer.Stakeholders.Tests/TestData/c-people.sql`
- `src/Modules/Stakeholders/Explorer.Stakeholders.Tests/TestData/d-profiles.sql`
<hr>

‚úÖ **Testiranje funkcionalnosti**
1. Pokrenuti API i otvoriti Swagger.
2. Ulogovati se na `/api/auth/login` koristeƒái seed naloge (npr. turista: `turista1@gmail.com` / `turista1`, autor: `autor1@gmail.com` / `autor1`) i preuzeti JWT token.
3. Za turiste: pozvati `GET /api/tourist/profile` sa Bearer tokenom i proveriti vraƒáene podatke.
4. Za turiste: pozvati `PUT /api/tourist/profile` sa telom koje sadr≈æi `name`, `surname`, opciono `biography`, `motto`, `profilePictureUrl`; oƒçekivati 200 OK i a≈æurirane vrednosti.
5. Za autore: analogno koracima 3‚Äì4 koristiti rute `GET /api/author/profile` i `PUT /api/author/profile`.
6. (Opcionalno) Proveriti u bazi da je red u `stakeholders."Profiles"` a≈æuriran za odgovarajuƒái `PersonId`.

Link do front-a: N/A (nije obezbeƒëen PR za front).
